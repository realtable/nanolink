#!/usr/bin/env node
(()=>{"use strict";var t={209:t=>{t.exports={}},607:function(t,e,r){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=s(r(127)),a=s(r(417)),n=s(r(747)),i=s(r(209)),l=o.default();var u=()=>a.default.randomBytes(4).toString("hex");function p(t,e,r){r.status(t),r.set("Content-Type","text/plain"),r.send(e)}l.get("/create/*",(t,e)=>{let r=u();for(;i.default[r];)r=u();let s=t.params[0],o="/";o=s.startsWith("https://")?s.replace("https://","//"):s.startsWith("http://")?s.replace("http://","//"):s.startsWith("//")?s:"//"+s;for(let t in i.default)if(i.default.hasOwnProperty(t)&&i.default[t]==o){r=t;break}i.default[r]=o,n.default.writeFileSync("database.json",JSON.stringify(i.default)),p(200,`200 Success: ${`${t.protocol}://${t.get("host")}/${r}`}`,e)}),l.get("/:id",(t,e)=>{let r=i.default[t.params.id];r?e.redirect(r):p(404,"404 File Not Found",e)}),l.get("/",(t,e)=>{p(200,`*** nanolink ***\nQuery ${`${t.protocol}://${t.get("host")}`}/create/myURL to create a new link for 'myURL'.\nIf you find a bug, please report it at https://github.com/realtable/nanolink/issues.`,e)}),l.listen(3e3,()=>console.log("nanolink server listening on port 3000"))},417:t=>{t.exports=require("crypto")},127:t=>{t.exports=require("express")},747:t=>{t.exports=require("fs")}},e={};!function r(s){if(e[s])return e[s].exports;var o=e[s]={exports:{}};return t[s].call(o.exports,o,o.exports,r),o.exports}(607)})();